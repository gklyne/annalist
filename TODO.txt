# Explorations

* Choose web server
  * probably Apache, considering nginx, but deferred until suitable OAuth2/OpenID-connect plugin is available
  * until then, using DJango for everything while ideas are fleshed out
* Authentication mechanism
  * Going with OAuth2/OpenID-Connect for now
  * Currently workingwith Google as IDP; loooking for alternatives
  * Considering OAuth2-Shibboleth bridge for uni deployment (have link somewhere in notes)
* Access control model
  * TBD; expect to use elements from UMA in due course
  * For now have very simple authorization function that requires authentication for up-dates, otherwise open.
* Define on-disk structure
    * Directories
    * Files
    * See https://github.com/gklyne/annalist/blob/develop/src/annalist_site/annalist/layout.py
    * @@NOTE: need to wean off direct directory access and use HTTP
* Define data access internal API details for web site
  * First cut in progress
  * @@NOTE: remember to use simple GET semantics where possible; may need to revisist and simplify
* Define UI generation details
* Implement data access API details
  * Mostly straight HTTP GET, etc
* Implement UI generation details
  * The main challenge.
  * Follow mockups per https://github.com/gklyne/annalist/tree/develop/mockup
* Create core UI definitions


## Web application

1. Front page/initial display
   / form elements to create new collection
   / form elements to delete collection
   / include supporting logic in Collection module
   / rework authentication/authorization to allow unauthenticated access for public data 
   / test cases for site, site views; refactor tests to separate directory, modules
   / adopt responsive CSS framework (Foundation)
2. Collection display
   / refactor metadata field access to common superclass
   / types
    / implement skeleton RecordType module
    / create test cases for types in collection
    / implement type methods
   / views
    / implement skeleton RecordView module
    / create test cases for views in collection
    / implement view methods
   / lists
    / implement skeleton RecordList module
    / create test cases for lists in collection
    / implement list methods
   - UI test cases
   - form elements to add/delete types/views/lists/...
3. Record type display
4. Default record list display (code may later be refactored)
5. Design generic entity view
6. Record view display and editing
7. Generic record list display and editing
8. ...

Misc
- Login link to include option to redirect to failed page, with form fields populated
- Complete authorization framework, per collection
- can "Confirm" form continue to a DELETE operation?  Can forms reliably do this?  

Use server-internal revectoring?  What about delete multiple?
- view collections doesn't use entered label - problem with entry vocab?
- util.write_entity: think about capturing provenance metadata too.
- move util.py to utils package, and rename?

AnalistGenericView:
- Generic renderers, all driven by a supplied dictionary:
  - HTML
  - JSON-LD
  - uri-list
- but serve native format directly.  Note that it should be possible to take an Annbalist sirte directory and dump it onto any regular HTTP server to publish thje raw data.  Web site should still be able to work with that.

Deployment: look into using Vagrant and/or Puppet/Chef/...


## Dynamic form interface

(To be planned)


## Authorization

* Assume use of annalist form data under control of suitable authority
* Focus on form of authorization data
* Back-fit to form interface for creation of data; figure what seeding is needed

